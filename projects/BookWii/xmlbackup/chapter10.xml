<?xml version='1.0' encoding='Shift_JIS' ?>

<doc xml:lang='ja'>
<head>
<title>センサーバーを自作してみよう</title>
<author>白井暁彦</author>
<date>2008年9月30日版</date>
<hp>http://akihiko.shirai.as/projects/BookWii/</hp>
<email>shirai@mail.com</email>

</head>
<body>

WiiRemoteの赤外線センサは非常に多機能で高速ですが、このままの状態では、センサーバーをWii本体に接続していなければ使えません。せっかくPCでWiiRemoteが使えるので、Wii本体がなくてもよいように、センサーバーの仕組みを知り、自作に挑戦してみましょう。

WiiRemoteの加速度センサーだけ使う予定の読者の方や、センサーバーをWii本体に接続して利用する方は、この節は読み飛ばしていただいてもかまいません。

<section title="センサーバーのしくみ">
センサーバーは、名前だけ聞くと『中にセンサーが入っている』ように聞こえますが、実際には赤外線センサーはWiiRemote内に実装されており、センサーバー内部にセンサーは存在しません。

センサーバー内部には、左右にそれぞれ5つの赤外線LEDが実装されています。Wii本体と接続しているケーブルは、電源ケーブルで、信号を送って同期したり、変調（周波数を変えて明度や速度を調整すること）したり、といった凝ったことはしていないようです。単純に直流電流を使って、同じ明るさで点灯しています。

同期や変調といった複雑な電子回路の場合は、自分で作るのは大変ですが、LED点灯回路ぐらいであればそれほど難しくはありません(中学生レベルの電子回路です)。このLED点灯回路を赤外線LEDを用いて自作すれば、センサーバーは必要なくなります。PCでWiiRemoteを利用するのに、いちいちWii本体を起動してセンサーバーを点灯させる必要はありませんし、赤外線センサーを使った自作の作品を利用する上での自由度もでてきます。

<figure id="fig:SensorBar" src="png/SensorBar.png" title="センサーバー赤外線をデジカメで撮影した様子">
 <attribute locale="latex2e" name="style">width:8cm</attribute>
</figure>

</section>

<section title="目には見えない赤外線">
さて、ここでは赤外線について学んでおきましょう(十分に知識がある方は読み飛ばしてください)。まず、世の中の光にはすべて「波長」があります。波長が変わると色が変わります。虹やプリズムを通して太陽の光を分解してみることができますが「赤橙黄緑青藍紫」という順番に並んで見えます。赤色に近くなればなるほど長い波長、紫色に近くなればなるほど短い波長です。人間が肉眼で見ることができる波長「可視光」は実際には限りがあって、赤の800nm(ナノメートル)から紫の400nm程度といわれています(人によって個人差はあります)。そしてこの赤より長い波長、紫より短い波長をそれぞれ「赤外線」「紫外線」と呼んでいます。

赤外線には800nm近辺の「近赤外線」と900nm以上の「遠赤外線」があります。それ以上波長が長くなると「マイクロ波」「メートル波」「電波」と呼ばれます。同様に紫外線もさらに波長が短くなると「X線」や「ガンマ線」など呼び方が異なります。呼び方が異なっても結局のところ、光は光です。人体に吸収されたりされなかったり、お湯が沸いたり、無線通信できたり、と各波長ごとにいろんな利用上の特性がありますが、特にWiiRemoteを使う上では波長1000〜800nmの近赤外線の特徴を知っておくとよいでしょう(※分野によっては2.5μメートルぐらいまでを近赤外と呼ぶこともあります)。

<figure id="fig:ImageNotYet" src="png/ImageNotYet.png" title="(★未描画イラスト)波長と虹">
 <attribute locale="latex2e" name="style">width:4cm</attribute>
</figure>


前述のとおり赤外線は目に見ることができませんが、可視光に近いため、目に見える光に似た拡散や反射が観察できます。目に見えないという理由から、自動ドアの接触センサー(フォトインタラプタ)や、テレビのリモコン、軍用や監視カメラの暗視スコープ(ノクトビジョン)などに使われています。こうしてみると、街の中は赤外線センサーだらけなのです！赤外線は熱を発する物体なら何でも、黒体放射で観測することができます(温度に応じて波長が変わります)。白熱電球なども熱と赤外線を出しますが、WiiRemoteのような可視光や熱が必要でないセンシングに使う場合は効率が良くないので、より安定した赤外線光源として、赤外線LEDの発光を使う場合が多いようです\cite{HikariMap}。
センシング用途では、赤外線LED光源にあわせて、フォトダイオード(PD)やフォトトランジスタといった特定の波長の光に対して反応する半導体とセットで利用されます。TVのリモコンや携帯電話やPCの近距離通信に使うIRDAもこの赤外線LEDと半導体素子のセット構成されています。

目には見えない赤外線ですが、デジカメや携帯、Webカメラなどの画像センサーを使うことで、赤外線を画像として見ることができます。本来、これらのカメラに利用されている画像センサーである「CCD」や「CMOS」は、特定された幅の波長の光しか電子に変換できないのですが、赤・緑・青のそれぞれの人間が画像として利用するための波長以外にほんの少し、可視光の外側の波長に対するセンサー感度を利用して「見えないものを見る」ことができます。夜中や暗闇でも撮影できるカメラ「ノクトビジョン」や「ナイトスコープ」は、この仕組みを使って目に見えない赤外線という明かりをつかって撮影できるのです(フィルターを使って赤外線域を見えなくしている製品もあります)。この知識は非常に有効で、センサーバーを自作したときや動作確認をする上で、赤外線が見えるカメラを手元においておくと、非常に便利です。

さてWiiRemoteの場合はどうなっているのでしょう？公開されている資料を見る限りでは、任天堂が台湾のPIXART社に特注して開発した、特別な赤外線画像センサーを利用しているようです。推測の範囲を出ませんが、PSD(Position Sensing Device)という低解像度の半導体で、画像ではなく赤外線の明かりの重心の位置を高速に出力できます。一般的な画像処理が毎秒30-60フレーム程度なのに対して、このPSDは2次元の重心位置を出力するだけなら毎秒400フレームぐらい出せるデバイスもあります。同じような赤外線センサーはゲーム製品では「剣神ドラゴンクエスト」などにも利用されていたことがあります。WiiRemoteに利用されているセンサーの特徴は「フレーム内に入った複数の赤外線の点が高速に出力できる」という点のようです(コストの安さも重要な利点でしょうね！)。


</section>

<section title="★電子部品をそろえる・工作する">


<figure id="fig:Circuit" src="png/Circuit.png" title="自作USBセンサーバーの回路例">
 <attribute locale="latex2e" name="style">width:8cm</attribute>
</figure>

<figure id="fig:miniIR" src="png/miniIR.png" title="小型の自作USBセンサーバーの制作例">
 <attribute locale="latex2e" name="style">width:8cm</attribute>
</figure>


</section>

</body>
</doc>
