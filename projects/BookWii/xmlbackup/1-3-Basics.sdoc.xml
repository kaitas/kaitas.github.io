<?xml version='1.0' encoding='Shift_JIS' ?>

<doc xml:lang='ja'>
<head>
<title>WiiRemoteの基礎知識</title>
<author>白井暁彦</author>
<date>2008年11月13日版</date>
<hp>http://akihiko.shirai.as/projects/BookWii/</hp>
<email>shirai@mail.com</email>

</head>
<body>

ここでは、WiiRemoteを使ったプログラミングを学ぶ前に、まずWiiRemoteの基礎知識をまとめておきます。

<subsection title="“革命”の主人公「Wiiリモコン」">
「Wii」は2006年末に発売された、任天堂の家庭用ゲーム機です。英語の「We(わたしたち)」と特徴的なリモコンを表す「ii」をかけて「Wii」と名付けられたようです。このWiiが発売される以前の開発コードは「Revolution(レヴォリューション：革命)」と呼ばれていました。2005年の米国「E3」(Electronic Entertainment Expo；エレクトロニック・エンターテインメント・ エキスポ、日本での東京ゲームショーにあたるゲーム産業における世界的な見本市)でこのコードネームが発表されました。

<native format="latex2e"><figure src="fig/revo_1a.jpg" title="コードネーム「Revolution」時代のロゴ(任天堂HPより)"/></native>
<native format="html4"><figure src="http://www.nintendo.co.jp/n10/e3_2005/revo/img/revo_1a.jpg" title="コードネーム「Revolution」時代のロゴ(任天堂HPより)"/></native>



「革命」という名にふさわしく、Revolutionはいままでの家庭用ゲーム機とは大きく異なるコンセプトで設計されています。詳しくは<a href="http://www.nintendo.co.jp/wii/topics/interview/vol1/index.html">「社長が訊く Wiiプロジェクト(任天堂公式HP)」</a>に、開発チームと社長の対談という形式で発表されていますが、簡単に表現すると、任天堂・岩田社長は2002年頃「このままゲームが複雑になっていったら、ゲーム業界は縮小する」と考え、その結論として新しいハードウェア設計のほとんど全てにおいて見直しを行った点が大きな「革命」であったといえるでしょう。対象とするユーザ層を従来の青少年層から比べて幅広く設定し、ゲームの遊び方、それを取り囲む環境、性能の設定や消費電力など、事細かにすべて今までの家庭用ゲーム機の進化の流れとは異なった方向になっています。

常時接続ネットワーク機能や縦置きデザイン、性能などさまざまな特徴がありますが、特にその中でも最も大きな役割を持っている「“革命”の主人公」とも言うべき存在が「Wiiリモコン」でしょう。無線化された片手で持つ、モーションセンサ。このように「指先ではなく、全身の動作」に注目したヒューマンインターフェース(機械と人間をつなぐ装置)を使った遊び体験は、ダンスゲームを除けばヴァーチャルリアリティ技術やアミューズメントテーマパークなど、ごく一部のエンタテイメントシステムには利用されていましたが、まだまだ高価で家庭用ゲーム機になじむとは思われてはいませんでした。レーシングゲームや釣りゲームのような一部のゲームジャンルにおいて、別売のコントローラーを必要とする例もありますが、やはり「プラットフォームが提供する標準コントローラー」という存在はインパクトがあります。かつてこの種のゲーム用特殊デバイスは多くの研究者・開発者が取り組んできましたが、汎用的な利用方法とその価格に問題があり、なかなか実現しませんでした。しかし発売日に1000万台以上が見込める新ハードに採用されるとなると、一台のコントローラー価格は5000円以下で販売されます(＝ゲームソフトよりも同価格かそれ以下、さらに一般的にハードの製造コストは売価の半分程度に設定されるべきです)。「いままでのエンターテイメント技術者の夢が一気に家庭にやってくる！」、「でもどうやって？」世界中のヒューマンインタフェースやエンタテイメント技術の研究者はこのニュースに色めき立ちました。

その後、Wiiが発売されてから2年が経ちますが、WiiRemoteの存在感は全く失われていません。当初はストラップやジャケットを着用せず、テレビを破壊したり、テニスのやり過ぎでヒジを痛める「急性Wii痛」などネガティブな話題でも賑わせましたが、バーチャルコンソールなどのクラシックコントローラーを利用する場合を除いて、WiiRemoteに対する否定的な意見はほとんどありません。またWiiRemote単体の販売価格も徐々に下がり、入手しやすくなっています。ゲームの歴史における革命児は市民権を得ている状態といえるでしょう。

</subsection>

<subsection title="WiiRemoteのしくみ">
さて、この節ではWiiRemoteのハードウェア的な仕組みを解説します。ブラックボックス化しがちな技術を理解するためには、まず皆さんが「発売前を想定して、自分で開発するつもり」になってみるとよいでしょう。

前述の通り、WiiRemoteは革命的な操作体験を提供しつつも「5000円を切る販売価格で」という要求仕様があったようです。しかしWiiRemoteはゲームのためのコントローラーですから、従来のボタンアクションやその操作の反応速度も維持しつつ、無線化を実現する必要があります。またバイブレーターもあったほうがいいですし、電池もできれば長持ちして欲しいでしょう。これらは非常に難しい要求です。

コードネーム「Revolution」時代、「コントローラーにはモーションセンサが載るらしい」という噂はありました。いままでのゲームボーイなどのゲームに採用されていたテキサスインスツルメンツ社製の加速度センサのようなものが利用されることは想像されていましたし、実際にNECトーキン社からも、加速度センサ、角速度センサ、地磁気センサを組み合わせた高価なエンタテイメント用センサー部品が発売されていましたので「技術的には不可能ではないだろう」と予想されていましたが「どうやったら想定される価格内に収まる製品になるのか？」は謎でした。これらのセンサーだけでは精度が十分ではありませんし、どんなゲームになるのかも想像つきませんでした。任天堂内部の開発者もいろいろな苦労と検討を重ねたようです。最終的にWiiRemoteには、赤外線CMOSセンサと赤外線光源を搭載したTVの上に置く「センサーバー」が付け加えられました。また当初の設計にはないスピーカーも加えられました。最終的に、WiiRemoteには以下の仕様になっています。

＜任天堂公式HPより＞

サイズ：縦148mm、横 36.2mm、厚さ30.8mm（突起部分を除く）

通信機能：Bluetoothによる無線接続、最大接続台数：４台

プレイ可能距離：テレビから５ｍ

ポインター：画面を指し示すポインティング機能

モーションセンサー：傾きや動きの変化を検出（3軸）

ボタン：１，２，Ａ，Ｂ，十字ボタン，−(マイナス)，Home(ホーム)，＋(プラス)ボタン

振動機能

スピーカー

プレイヤーインジケータ

拡張ユニット接続可能



以下は独自に調査した、より詳細なスペックと解説です(将来の仕様変更により変更される可能性があります)。
まず「モーションセンサー」ですが、3軸方向に各8ビットの精度の加速度センサーが実装されています。前後、左右、上下の各軸の加速度を検出することができますが、構造上、これだけでは位置入力、たとえば左右の振り角などは検出できません。そのため後述する「ポインター」が付け加えられています。

<native format="latex2e"><figure src="fig/Wiimote_axes.png" title="加速度センサーの検出軸(※Wiili.orgより図借用)"/></native>
<native format="html4"><figure src="http://www.wiili.org/images/b/b8/Wiimote_axes.png" title="加速度センサーの検出軸(※Wiili.orgより図借用)"/></native>


後で詳細を解説しますが「ポインター」は、赤外線を利用した独自開発の2次元センサーによって実現されています。CMOSと呼ばれる種類のセンサーですが、デジタルカメラのようなカラー画像を取得するものではありません。赤外線LEDを内蔵するセンサーバーから発せられる2箇所の光を距離や角度によらず、重心位置を取得します。これは2次元PSD(Position Sensing Device)と呼ばれるタイプのセンサー方式で、一般的には同時に複数の座標を取得することはできません。スクウェアエニックスから2003年に発売された「剣神ドラゴンクエスト」に採用されたセンサーと近いアイディアですが、台湾の製造会社と任天堂が努力の末に生み出した独自センサーと思われます。なお、仕様からには2箇所しか検出できないように見えるこのセンサーですが、PCから利用する場合、実際には4箇所まで検出できることがわかっています。

「ボタン」はOn/Offだけが検出できるデジタル入力が11個ついています。スロットルや感圧などアナログ入力ボタンがないのもWiiRemoteの特徴といえます。

「振動機能」は携帯電話などで使われる偏芯錘がついたモーターを用いたバイブレーターが1つ実装されています。On/Offしか制御できませんし1つしかないので、複雑な表現を行うにはテクニックが必要です。

「スピーカー」は専用のサウンドプロセッサが搭載されています。Wiiでの利用はともかく、PCから利用する場合、ピー...という音など矩形波を出すのはそれほど難しくはないのですが、音質はそれほど良くなく4-bitのADPCMのようです、また仕様が公開されているわけではないので、自由な音を出すのは最近まで難しい状況にありました。

「プレイヤーインジケータ」は4つの青色LEDです。Wiiで利用する場合はプレイヤー１〜４のコントローラーを表示するために利用されますが、PCから使う場合は比較的簡単に、自由に点灯状態を変えることができます。

WiiRemote下部にヌンチャクやクラシックコントローラを接続するための「拡張コネクタ」があり、周辺機器を接続することができますI2C（Inter-Integrated Circuit）による抜き差し自由で高速なシリアル通信が可能なようです。


最後にWii本体との通信を行っているBluetoothコントローラは「Broadcom 2042」であることが報告されています。Bloadcom社のホームページで公開されている情報によると、BCM2042は、適応型周波数ホッピングと高速接続をそなえたBluetooth 2.0完全互換仕様で、PC用マウスやキーボード応用に適した設計になっているチップであると解説されています(WiiRemoteではBluetooth1.2のHIDプロファイルで利用しているようです)。実際の通信においては、ボタンや加速度の入力が行われたときのみ、信号を送ります。無駄な通信を流し続けない設計もゲームコントローラーならでは、ですね。

他にもMiiデータなどを格納するためのフラッシュメモリーがありますが、本書では触れません。

どうでしょう？高速な無線通信が行えるBluetoothコントローラだけでも魅力的なのに、これだけの能力を持ったモジュールを含む製品が5000円以下で、しかも耐久性の高い量産品として販売されていること自体が驚きです。

こんなすばらしいデバイスを開発・販売している任天堂に敬意を払い、応援するためにも(＝この本で解説しているPCでの利用を流行させるためにも)、WiiRemote単体での購入をぜひぜひお勧めいたします。もちろんWii本体も。余談ですが筆者のフランスの研究室では、Wii発売当初は本体が手に入らず、研究開発のためにWiiRemoteだけ1ダースほど購入した時期もありました。

</subsection>


</body>
</doc>
